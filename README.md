# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта (MVP)

### Используемый стек

- **HTML, SCSS** — верстка и стилизация
- **TypeScript** — типизация и ООП
- **Webpack** — сборка проекта
- **Событийная модель (EventEmitter)** — для связи между слоями

---

### Общая структура и паттерн

Проект реализован по паттерну **MVP (Model-View-Presenter)** с событийно-ориентированным взаимодействием между слоями:

- **Model** — отвечает за хранение и обработку данных (товары, корзина, заказ)
- **View** — отвечает за отображение данных и пользовательский интерфейс (карточки, модальные окна, формы)
- **Presenter** — связывает Model и View, реагирует на события, координирует логику приложения (реализуется в основном скрипте через подписки на события)

---

### Слои и основные классы

#### 1. Слой Модели (Model)

- **ProductModel**
  - Хранит список товаров, выбранный товар
  - Методы: загрузка товаров, выбор товара, добавление/удаление из корзины, очистка корзины
  - Генерирует события при изменении данных

- **BasketModel**
  - Хранит содержимое корзины
  - Методы: добавить/удалить товар, рассчитать сумму, очистить корзину
  - Генерирует события при изменении корзины

- **OrderModel**
  - Хранит данные заказа (адрес, email, телефон, способ оплаты)
  - Методы: заполнение/очистка данных, валидация, оформление заказа
  - Генерирует события при изменении/отправке заказа

#### 2. Слой Представления (View)

- **ProductListView**
  - Отображает каталог товаров
  - Получает данные от Presenter, рендерит карточки, реагирует на клики

- **ProductCardView**
  - Отображает детальную информацию о товаре (в модалке)
  - Управляет кнопками "В корзину"/"Удалить"

- **BasketView**
  - Отображает содержимое корзины, сумму, кнопки оформления

- **OrderFormView**
  - Отображает формы оформления заказа (шаги: адрес, оплата, email, телефон)
  - Управляет валидацией и состоянием кнопок

- **ModalView**
  - Универсальный компонент для отображения модальных окон
  - Управляет открытием/закрытием, вставкой контента

#### 3. Слой Presenter

- Реализуется в основном скрипте (`src/index.ts`)
- Подписывается на события от View и Model
- Координирует логику: обработка кликов, обновление моделей, рендеринг View

#### 4. Базовые классы и утилиты

- **Api** — клиент для работы с сервером (получение товаров, отправка заказа)
- **EventEmitter** — брокер событий для связи между слоями
- **Утилиты** — функции для форматирования, валидации, работы с DOM

---

### Взаимодействие между слоями

- View генерирует события (например, "card:select", "basket:add", "order:submit")
- Presenter обрабатывает события, вызывает методы Model
- Model изменяет данные, генерирует события ("products:changed", "basket:changed", "order:success")
- Presenter реагирует на события Model, обновляет View

---

### Описание основных событий

- **card:select** — пользователь выбрал товар (View → Presenter)
- **basket:add** — добавить товар в корзину (View → Presenter)
- **basket:remove** — удалить товар из корзины (View → Presenter)
- **order:submit** — отправка заказа (View → Presenter)
- **products:changed** — изменился список товаров (Model → Presenter/View)
- **basket:changed** — изменилась корзина (Model → Presenter/View)
- **order:success** — заказ успешно оформлен (Model → Presenter/View)

---

### Пример сценария (MVP)

1. Пользователь кликает по карточке товара (ProductListView генерирует "card:select")
2. Presenter получает событие, вызывает ProductModel для выбора товара
3. ProductModel обновляет выбранный товар, генерирует "products:changed"
4. Presenter получает событие, вызывает ProductCardView для отображения модалки с деталями товара
5. Пользователь нажимает "В корзину" — ProductCardView генерирует "basket:add"
6. Presenter вызывает BasketModel для добавления товара, BasketModel генерирует "basket:changed"
7. Presenter обновляет BasketView

---

### Типы данных

- Описаны в `src/types/index.ts` (см. следующий шаг)
